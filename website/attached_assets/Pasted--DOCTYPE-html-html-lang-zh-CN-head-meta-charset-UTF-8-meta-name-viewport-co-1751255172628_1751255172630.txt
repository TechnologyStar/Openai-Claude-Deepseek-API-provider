<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI èŠå¤©å·¥å…·æ¨èè¡¨ç”Ÿæˆå™¨</title>
  <style>
    /* å…¨å±€æ ·å¼ */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f0f2f5;
      padding: 20px;
      color: #333;
    }
    h2, h3 {
      margin-bottom: 12px;
      color: #444;
    }
    /* å¡ç‰‡å®¹å™¨æ ·å¼ */
    .card {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      padding: 20px;
    }
    .legend p {
      margin-bottom: 8px;
      line-height: 1.6;
    }
    /* è¾“å…¥åŒºåŸŸæ ·å¼ */
    .input-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      margin-top: 10px;
    }
    .input-row input[type="text"],
    .input-row input[type="url"],
    .input-row input[type="password"],
    .input-row textarea {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 8px;
      font-size: 14px;
      background-color: #fafafa;
      transition: border-color 0.2s;
    }
    .input-row input[type="text"] {
      width: 160px;
    }
    .input-row input[type="url"] {
      width: 200px;
    }
    .input-row input[type="password"] {
      width: 200px;
    }
    .input-row textarea {
      width: 280px;
      height: 28px;
      resize: vertical;
    }
    .input-row input:focus,
    .input-row textarea:focus {
      border-color: #409eff;
      outline: none;
      background-color: #fff;
    }
    /* æŒ‰é’®æ ·å¼ */
    button {
      border: none;
      border-radius: 4px;
      background-color: #409eff;
      color: #fff;
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #66b1ff;
    }
    button:active {
      background-color: #3a8ee6;
    }
    /* å¤é€‰æ¡†æ ‡ç­¾æ ·å¼ */
    #tagCheckboxes {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      max-width: 400px;
      margin-top: 4px;
    }
    #tagCheckboxes label {
      display: flex;
      align-items: center;
      background-color: #eef2f7;
      border-radius: 4px;
      padding: 4px 8px;
      font-size: 13px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    #tagCheckboxes input[type="checkbox"] {
      margin-right: 4px;
      accent-color: #409eff;
    }
    #tagCheckboxes label:hover {
      background-color: #dde6f7;
    }
    /* è¡¨æ ¼æ ·å¼ */
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    th, td {
      border-bottom: 1px solid #ececec;
      padding: 12px;
      text-align: left;
      vertical-align: top;
      font-size: 14px;
      color: #555;
    }
    th {
      background-color: #f7f9fc;
      font-weight: 600;
    }
    tbody tr:hover {
      background-color: #f5f7fa;
    }
    .row-buttons button {
      margin-right: 6px;
      padding: 4px 8px;
      font-size: 13px;
      background-color: #67c23a;
    }
    .row-buttons button:hover {
      background-color: #85ce61;
    }
    .row-buttons button:active {
      background-color: #5daf31;
    }
    /* æ–‡æœ¬åŒºåŸŸæ ·å¼ */
    #generatedHtml {
      width: 100%;
      height: 300px;
      font-family: Consolas, "Courier New", monospace;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 10px;
      resize: vertical;
      background-color: #fafafa;
      margin-top: 10px;
    }
    /* è¾…åŠ©æŒ‰é’®æ ·å¼ */
    #copyHtmlBtn {
      margin-left: 10px;
      background-color: #e6a23c;
    }
    #copyHtmlBtn:hover {
      background-color: #ebb563;
    }
    #copyHtmlBtn:active {
      background-color: #c5802f;
    }
    /* åŠ è½½çŠ¶æ€ */
    .loading {
      opacity: 0.6;
      pointer-events: none;
    }
    /* è®¾ç½®é¢æ¿ */
    #settingsPanel {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      width: 400px;
      z-index: 1000;
    }
    #settingsPanel h3 {
      margin-bottom: 10px;
    }
    #settingsOverlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 999;
    }
    #settingsPanel input {
      width: 100%;
      margin-bottom: 12px;
    }
    #settingsPanel button {
      width: 48%;
      margin-right: 4%;
    }
    #settingsPanel button:last-child {
      margin-right: 0;
    }
  </style>
</head>
<body>
  <h2>AI èŠå¤©å·¥å…·æ¨èè¡¨ç”Ÿæˆå™¨</h2>
  <div class="card legend">
    <p><strong>èµåŠ©æ–¹å¹³å°å°†åŠ å…¥é‚€è¯·ç ï¼Œæ„Ÿè°¢æ‚¨çš„æ”¯æŒ</strong></p>
    <p><strong>æ ‡ç­¾å«ä¹‰ï¼š</strong><br>
    &emsp;- ğŸ†“ å®Œå…¨å…è´¹<br>
    &emsp;- ğŸ”“ æœ‰å…è´¹é¢åº¦<br>
    &emsp;- ğŸ’° éœ€è¦å……å€¼<br>
    &emsp;- ğŸ’ª æ”¯æŒ Claude æœ€æ–°æ¨¡å‹<br>
    &emsp;- âœŒ æ”¯æŒ OpenAI æœ€æ–°æ¨¡å‹<br>
    &emsp;- ğŸ‰ æ”¯æŒå…¶ä»–æ¨¡å‹æˆ–å…¶ä»–åŠŸèƒ½<br>
    &emsp;- ğŸŒ éœ€è¦å›½é™…ç½‘ç»œ<br>
    &emsp;- ğŸ å……å€¼æœ‰è¾ƒå¤§ä¼˜æƒ ï¼ˆ<50%ï¼‰<br>
    &emsp;- ğŸš€ æ”¯æŒé«˜å¹¶å‘<br>
    &emsp;- ğŸ˜† ç­¾åˆ°é¢†ä½™é¢<br>
    &emsp;- ğŸš© ç½‘ç«™é€šè¿‡ä¸­å›½å¤‡æ¡ˆ<br>
    &emsp;- âœ” å·²éªŒè¯å®‰å…¨æ€§/çœŸå®æ€§</p>
  </div>

  <!-- å¯¼å…¥åŸæœ‰ä¾›åº”å•† HTML -->
  <div class="card import-section">
    <h3>ğŸ“¥ å¯¼å…¥åŸæœ‰ä¾›åº”å•† HTML</h3>
    <p>è¯·åœ¨ä¸‹æ–¹ç²˜è´´å·²æœ‰çš„ <code>&lt;table&gt;</code> éƒ¨åˆ†ï¼ˆä» <code>&lt;table&gt;</code> åˆ° <code>&lt;/table&gt;</code>ï¼‰ï¼Œç„¶åç‚¹å‡»â€œå¯¼å…¥ä¾›åº”å•†â€æŒ‰é’®ã€‚</p>
    <textarea id="importHtmlTextarea" placeholder="åœ¨æ­¤ç²˜è´´åŸæœ‰çš„ <table> ... </table> HTML ä»£ç "></textarea>
    <button id="importBtn" style="margin-top: 10px;">å¯¼å…¥ä¾›åº”å•†</button>
  </div>

  <!-- æ–°å¢æˆ–ç¼–è¾‘ä¾›åº”å•†é¡¹ -->
  <div class="card input-section">
    <h3>â• æ·»åŠ æˆ–ç¼–è¾‘ä¾›åº”å•†</h3>
    <div class="input-row">
      <input type="text" id="siteName" placeholder="ç½‘ç«™åç§°" disabled />
      <input type="url" id="siteLink" placeholder="é“¾æ¥ (åŒ…å« https://)" />
      <input type="password" id="apiKeyInput" placeholder="OpenAI API Key (sk-...)" />
      <button id="autoTagBtn">AI è‡ªåŠ¨æ ‡æ³¨</button>
      <button id="openSettingsBtn">è®¾ç½®</button>
    </div>
    <div class="input-row" style="margin-top: 8px;">
      <div id="tagCheckboxes">
        <label><input type="checkbox" value="ğŸ†“">ğŸ†“</label>
        <label><input type="checkbox" value="ğŸ”“">ğŸ”“</label>
        <label><input type="checkbox" value="ğŸ’°">ğŸ’°</label>
        <label><input type="checkbox" value="ğŸ’ª">ğŸ’ª</label>
        <label><input type="checkbox" value="âœŒ">âœŒ</label>
        <label><input type="checkbox" value="ğŸ‰">ğŸ‰</label>
        <label><input type="checkbox" value="ğŸŒ">ğŸŒ</label>
        <label><input type="checkbox" value="ğŸ">ğŸ</label>
        <label><input type="checkbox" value="ğŸš€">ğŸš€</label>
        <label><input type="checkbox" value="ğŸ˜†">ğŸ˜†</label>
        <label><input type="checkbox" value="ğŸš©">ğŸš©</label>
        <label><input type="checkbox" value="âœ”">âœ”</label>
      </div>
      <textarea id="siteRemark" placeholder="å¤‡æ³¨"></textarea>
      <button id="addRowBtn" disabled>æ·»åŠ æä¾›æ–¹</button>
    </div>
  </div>

  <!-- ç¼–è¾‘è¡¨æ ¼åŒº -->
  <div class="card">
    <table id="providerTable">
      <thead>
        <tr>
          <th style="width: 60px;">åºå·</th>
          <th>ç½‘ç«™</th>
          <th>é“¾æ¥</th>
          <th>æ ‡ç­¾</th>
          <th>å¤‡æ³¨</th>
          <th style="width: 120px;">æ“ä½œ</th>
        </tr>
      </thead>
      <tbody>
        <!-- åŠ¨æ€æ’å…¥è¡Œ -->
      </tbody>
    </table>
  </div>

  <!-- ç”Ÿæˆä¸å¤åˆ¶ HTML -->
  <button id="generateHtmlBtn">ä¸€é”®ç”Ÿæˆ HTML</button>
  <button id="copyHtmlBtn">å¤åˆ¶ HTML åˆ°å‰ªè´´æ¿</button>
  <textarea id="generatedHtml" readonly placeholder="ç”Ÿæˆçš„ HTML ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œå¯ä¸€é”®å¤åˆ¶"></textarea>

  <!-- è®¾ç½®é¢æ¿ -->
  <div id="settingsOverlay"></div>
  <div id="settingsPanel">
    <h3>âš™ï¸ API è®¾ç½®</h3>
    <label for="apiUrlInput">è¯·æ±‚ URL:</label>
    <input type="text" id="apiUrlInput" value="https://api.openai.com/v1/chat/completions" />
    <label for="modelInput">æ¨¡å‹:</label>
    <input type="text" id="modelInput" value="gpt-3.5-turbo" />
    <div style="text-align: right;">
      <button id="saveSettingsBtn">ä¿å­˜</button>
      <button id="cancelSettingsBtn">å–æ¶ˆ</button>
    </div>
  </div>

  <script>
    let apiUrl = 'https://api.openai.com/v1/chat/completions';
    let modelName = 'gpt-3.5-turbo';

    const providerTableBody = document.querySelector('#providerTable tbody');
    const siteNameInput = document.getElementById('siteName');
    const siteLinkInput = document.getElementById('siteLink');
    const apiKeyInput = document.getElementById('apiKeyInput');
    const autoTagBtn = document.getElementById('autoTagBtn');
    const addRowBtn = document.getElementById('addRowBtn');
    const generateHtmlBtn = document.getElementById('generateHtmlBtn');
    const copyHtmlBtn = document.getElementById('copyHtmlBtn');
    const generatedHtmlTextarea = document.getElementById('generatedHtml');
    const importBtn = document.getElementById('importBtn');
    const importHtmlTextarea = document.getElementById('importHtmlTextarea');
    const openSettingsBtn = document.getElementById('openSettingsBtn');
    const settingsOverlay = document.getElementById('settingsOverlay');
    const settingsPanel = document.getElementById('settingsPanel');
    const apiUrlInput = document.getElementById('apiUrlInput');
    const modelInput = document.getElementById('modelInput');
    const saveSettingsBtn = document.getElementById('saveSettingsBtn');
    const cancelSettingsBtn = document.getElementById('cancelSettingsBtn');

    // æ›´æ–°åºå·
    function updateRowNumbers() {
      const rows = providerTableBody.querySelectorAll('tr');
      rows.forEach((row, index) => {
        row.querySelector('.indexCell').innerText = index + 1;
      });
    }

    // åˆ›å»ºä¸€è¡Œ
    function createRow(name, link, tags, remark) {
      const tr = document.createElement('tr');

      const indexTd = document.createElement('td');
      indexTd.className = 'indexCell';
      indexTd.innerText = providerTableBody.children.length + 1;

      const nameTd = document.createElement('td');
      nameTd.contentEditable = true;
      nameTd.innerText = name;

      const linkTd = document.createElement('td');
      linkTd.contentEditable = true;
      const a = document.createElement('a');
      a.href = link;
      a.innerText = link;
      a.target = '_blank';
      linkTd.appendChild(a);

      const tagsTd = document.createElement('td');
      tagsTd.contentEditable = true;
      tagsTd.innerText = tags;

      const remarkTd = document.createElement('td');
      remarkTd.contentEditable = true;
      remarkTd.innerText = remark;

      const actionTd = document.createElement('td');
      actionTd.className = 'row-buttons';
      const upBtn = document.createElement('button');
      upBtn.innerText = 'â†‘'; upBtn.onclick = () => moveRowUp(tr);
      const downBtn = document.createElement('button');
      downBtn.innerText = 'â†“'; downBtn.onclick = () => moveRowDown(tr);
      const deleteBtn = document.createElement('button');
      deleteBtn.innerText = 'åˆ é™¤'; deleteBtn.onclick = () => deleteRow(tr);
      actionTd.appendChild(upBtn);
      actionTd.appendChild(downBtn);
      actionTd.appendChild(deleteBtn);

      tr.appendChild(indexTd);
      tr.appendChild(nameTd);
      tr.appendChild(linkTd);
      tr.appendChild(tagsTd);
      tr.appendChild(remarkTd);
      tr.appendChild(actionTd);

      return tr;
    }

    // æ¸…ç©ºè¾“å…¥æ¡†
    function clearInputs() {
      siteNameInput.value = '';
      siteLinkInput.value = '';
      apiKeyInput.value = '';
      document.getElementById('siteRemark').value = '';
      document.querySelectorAll('#tagCheckboxes input[type="checkbox"]').forEach(chk => chk.checked = false);
      addRowBtn.disabled = true;
      siteNameInput.disabled = true;
    }

    // æ‰‹åŠ¨æ·»åŠ è¡Œ
    function addRow() {
      const name = siteNameInput.value.trim();
      const link = siteLinkInput.value.trim();
      const remark = document.getElementById('siteRemark').value.trim();

      const tagCheckboxes = document.querySelectorAll('#tagCheckboxes input[type="checkbox"]:checked');
      const selectedTags = Array.from(tagCheckboxes).map(chk => chk.value);
      const tags = selectedTags.join('');

      if (!name || !link) {
        alert('è¯·å¡«å†™â€œç½‘ç«™åç§°â€å’Œâ€œé“¾æ¥â€');
        return;
      }
      const newRow = createRow(name, link, tags, remark);
      providerTableBody.appendChild(newRow);
      updateRowNumbers();
      clearInputs();
    }

    // AI è‡ªåŠ¨æ ‡æ³¨ï¼Œç»“æœå¡«å……åˆ°è¾“å…¥æ¡†ï¼Œå¾…äººå·¥å¤æ ¸
    async function autoTagAndFill() {
      const key = apiKeyInput.value.trim();
      const link = siteLinkInput.value.trim();
      if (!key) { alert('è¯·å¡«å†™ OpenAI API Keyã€‚'); return; }
      if (!link) { alert('è¯·å¡«å†™â€œé“¾æ¥â€ä»¥è¿›è¡Œ AI è‡ªåŠ¨æ ‡æ³¨ã€‚'); return; }
      autoTagBtn.classList.add('loading');
      autoTagBtn.innerText = 'æ ‡æ³¨ä¸­...';

      const prompt = `è¯·æ ¹æ®ä»¥ä¸‹ç½‘ç«™é“¾æ¥ï¼Œæå–ç½‘ç«™åç§°ï¼Œå¹¶ç”Ÿæˆé€‚åˆçš„æ ‡ç­¾ï¼ˆä»ä»¥ä¸‹åˆ—è¡¨ä¸­é€‰æ‹©ï¼Œå¤šä¸ªæ ‡ç­¾è¯·ç”¨æ— ç©ºæ ¼è¿ç»­å­—ç¬¦å½¢å¼ï¼‰ï¼šğŸ†“ğŸ”“ğŸ’°ğŸ’ªâœŒğŸ‰ğŸŒğŸğŸš€ğŸ˜†ğŸš©âœ” ã€‚å¹¶ç”Ÿæˆä¸€å¥ç®€æ´å¤‡æ³¨ï¼Œè¯´æ˜è¯¥ç«™çš„ä¸»è¦ç‰¹ç‚¹ã€‚ä¾‹å¦‚ï¼š\nè¾“å…¥é“¾æ¥ï¼š${link}\nè¯·è¾“å‡º JSON æ ¼å¼ï¼š{\"name\": \"ç½‘ç«™åç§°\", \"tags\": \"æ ‡ç­¾ä¸²\", \"remark\": \"å¤‡æ³¨å†…å®¹\"}`;

      try {
        const response = await fetch(apiUrl, {
          method: 'POST', headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${key}` },
          body: JSON.stringify({ model: modelName, messages: [{ role: 'user', content: prompt }], temperature: 0.7, max_tokens: 500 })
        });
        const data = await response.json();
        const content = data.choices[0].message.content.trim();
        let obj;
        try { obj = JSON.parse(content); } catch (e) { const match = content.match(/\{[\s\S]*\}/); obj = match ? JSON.parse(match[0]) : null; }
        if (!obj || !obj.name) throw new Error('AI è¿”å›æ ¼å¼ä¸ç¬¦åˆè¦æ±‚');
        siteNameInput.value = obj.name;
        const tagsArr = obj.tags.split('');
        document.querySelectorAll('#tagCheckboxes input[type="checkbox"]').forEach(chk => chk.checked = tagsArr.includes(chk.value));
        document.getElementById('siteRemark').value = obj.remark;
        siteNameInput.disabled = false;
        addRowBtn.disabled = false;
      } catch (error) {
        console.error(error);
        alert('AI è‡ªåŠ¨æ ‡æ³¨å‡ºé”™ï¼Œè¯·æ£€æŸ¥ API Key ä¸ç½‘ç»œè¿æ¥ï¼Œæˆ–ç¨åé‡è¯•ã€‚');
      } finally {
        autoTagBtn.classList.remove('loading');
        autoTagBtn.innerText = 'AI è‡ªåŠ¨æ ‡æ³¨';
      }
    }

    // è¡Œä¸Šç§»
    function moveRowUp(row) {
      const prev = row.previousElementSibling;
      if (prev) { providerTableBody.insertBefore(row, prev); updateRowNumbers(); }
    }

    // è¡Œä¸‹ç§»
    function moveRowDown(row) {
      const next = row.nextElementSibling;
      if (next) { providerTableBody.insertBefore(next, row); updateRowNumbers(); }
    }

    // åˆ é™¤è¡Œ
    function deleteRow(row) {
      providerTableBody.removeChild(row);
      updateRowNumbers();
    }

    // ç”Ÿæˆæœ€ç»ˆ HTML
    function generateHtml() {
      let html = '<p><strong>èµåŠ©æ–¹å¹³å°å°†åŠ å…¥é‚€è¯·ç ï¼Œæ„Ÿè°¢æ‚¨çš„æ”¯æŒ</strong></p>\n';
      html += '<p><strong>æ ‡ç­¾å«ä¹‰ï¼š</strong><br>\n';
      html += '&emsp;- ğŸ†“ å®Œå…¨å…è´¹<br>\n';
      html += '&emsp;- ğŸ”“ æœ‰å…è´¹é¢åº¦<br>\n';
      html += '&emsp;- ğŸ’° éœ€è¦å……å€¼<br>\n';
      html += '&emsp;- ğŸ’ª æ”¯æŒ Claude æœ€æ–°æ¨¡å‹<br>\n';
      html += '&emsp;- âœŒ æ”¯æŒ OpenAI æœ€æ–°æ¨¡å‹<br>\n';
      html += '&emsp;- ğŸ‰ æ”¯æŒå…¶ä»–æ¨¡å‹æˆ–å…¶ä»–åŠŸèƒ½<br>\n';
      html += '&emsp;- ğŸŒ éœ€è¦å›½é™…ç½‘ç»œ<br>\n';
      html += '&emsp;- ğŸ å……å€¼æœ‰è¾ƒå¤§ä¼˜æƒ ï¼ˆ<50%ï¼‰<br>\n';
      html += '&emsp;- ğŸš€ æ”¯æŒé«˜å¹¶å‘<br>\n';
      html += '&emsp;- ğŸ˜† ç­¾åˆ°é¢†ä½™é¢<br>\n';
      html += '&emsp;- ğŸš© ç½‘ç«™é€šè¿‡ä¸­å›½å¤‡æ¡ˆ<br>\n';
      html += '&emsp;- âœ” å·²éªŒè¯å®‰å…¨æ€§/çœŸå®æ€§</p>\n\n';

      html += '<table border=\"1\" cellspacing=\"0\" cellpadding=\"6\">\n';
      html += '  <thead>\n';
      html += '    <tr>\n';
      html += '      <th>åºå·</th>\n';
      html += '      <th>ç½‘ç«™</th>\n';
      html += '      <th>é“¾æ¥</th>\n';
      html += '      <th>æ ‡ç­¾</th>\n';
      html += '      <th>å¤‡æ³¨</th>\n';
      html += '    </tr>\n';
      html += '  </thead>\n';
      html += '  <tbody>\n';

      const rows = providerTableBody.querySelectorAll('tr');
      rows.forEach((row, index) => {
        const cols = row.querySelectorAll('td');
        const name = cols[1].innerText.trim();
        const link = cols[2].querySelector('a').href.trim();
        const tags = cols[3].innerText.trim();
        const remark = cols[4].innerText.trim();

        html += '    <tr>\n';
        html += `      <td>${index + 1}</td>\n`;
        html += `      <td>${name}</td>\n`;
        html += `      <td><a href=\"${link}\" target=\"_blank\">${link}</a></td>\n`;
        html += `      <td>${tags}</td>\n`;
        html += `      <td>${remark}</td>\n`;
        html += '    </tr>\n';
      });

      html += '  </tbody>\n';
      html += '</table>';

      generatedHtmlTextarea.value = html;
    }

    // å¤åˆ¶ HTML åˆ°å‰ªè´´æ¿
    function copyHtmlToClipboard() {
      generatedHtmlTextarea.select();
      document.execCommand('copy');
      alert('HTML å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
    }

    // å¯¼å…¥å·²æœ‰çš„ <table> HTML
    function importProvidersFromHtml() {
      const rawHtml = importHtmlTextarea.value.trim();
      if (!rawHtml) { alert('è¯·å…ˆåœ¨ä¸Šæ–¹ç²˜è´´å·²æœ‰çš„ <table> ... </table> HTML ä»£ç ï¼'); return; }
      const parser = new DOMParser();
      const doc = parser.parseFromString(rawHtml, 'text/html');
      const rows = doc.querySelectorAll('tbody tr');
      if (!rows.length) { alert('æœªèƒ½è¯†åˆ«åˆ°æœ‰æ•ˆçš„ <tbody><tr> ... è¡Œï¼Œè¯·æ£€æŸ¥ç²˜è´´å†…å®¹æ ¼å¼'); return; }

      providerTableBody.innerHTML = '';
      rows.forEach(row => {
        const cols = row.querySelectorAll('td');
        if (cols.length < 5) return;
        const name = cols[1].innerText.trim();
        const linkATag = cols[2].querySelector('a');
        const link = linkATag ? linkATag.href.trim() : cols[2].innerText.trim();
        const tags = cols[3].innerText.trim();
        const remark = cols[4].innerText.trim();
        const newRow = createRow(name, link, tags, remark);
        providerTableBody.appendChild(newRow);
      });

      updateRowNumbers();
      alert('å¯¼å…¥å®Œæˆï¼å·²å°†è¡Œæ•°æ·»åŠ åˆ°è¡¨æ ¼ä¸­ã€‚');
      importHtmlTextarea.value = '';
    }

    // æ‰“å¼€è®¾ç½®é¢æ¿
    openSettingsBtn.addEventListener('click', () => {
      settingsOverlay.style.display = 'block';
      settingsPanel.style.display = 'block';
      apiUrlInput.value = apiUrl;
      modelInput.value = modelName;
    });
    // å–æ¶ˆè®¾ç½®
    cancelSettingsBtn.addEventListener('click', () => {
      settingsOverlay.style.display = 'none';
      settingsPanel.style.display = 'none';
    });
    // ä¿å­˜è®¾ç½®
    saveSettingsBtn.addEventListener('click', () => {
      apiUrl = apiUrlInput.value.trim() || apiUrl;
      modelName = modelInput.value.trim() || modelName;
      settingsOverlay.style.display = 'none';
      settingsPanel.style.display = 'none';
      alert(`è®¾ç½®å·²ä¿å­˜ï¼š\nè¯·æ±‚ URLï¼š${apiUrl}\næ¨¡å‹ï¼š${modelName}`);
    });

    autoTagBtn.addEventListener('click', autoTagAndFill);
    addRowBtn.addEventListener('click', addRow);
    generateHtmlBtn.addEventListener('click', generateHtml);
    copyHtmlBtn.addEventListener('click', copyHtmlToClipboard);
    importBtn.addEventListener('click', importProvidersFromHtml);
  </script>
</body>
</html>